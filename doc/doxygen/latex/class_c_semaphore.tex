\hypertarget{class_c_semaphore}{\section{C\-Semaphore Class Reference}
\label{class_c_semaphore}\index{C\-Semaphore@{C\-Semaphore}}
}


The \hyperlink{class_c_semaphore}{C\-Semaphore} class provides two kinds semaphore which counting and binary.  




{\ttfamily \#include \char`\"{}class/semaphore.\-h\char`\"{}}

Inheritance diagram for C\-Semaphore\-:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_c_semaphore}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual bool \hyperlink{class_c_semaphore_af4e913cd2861355f8be2211ae21753ba}{counting} (int count, int init=0)
\item 
virtual bool \hyperlink{class_c_semaphore_a0fc078dfd286cb3321c6cbaf7bcbb7b2}{binary} ()
\item 
virtual bool \hyperlink{class_c_semaphore_abad6f22e40a0d911e38ade968f4d801a}{wait} (int timeout=M\-A\-X\-\_\-\-D\-E\-L\-A\-Y\-\_\-\-T\-I\-M\-E)
\item 
virtual int \hyperlink{class_c_semaphore_aa1a25ff1be26f8dfdd0f008aeabec8b1}{release} (bool from\-I\-S\-R=false)
\item 
virtual int \hyperlink{class_c_semaphore_a2302ceb8f2f9e1bef3381f457589177d}{waiting} ()
\end{DoxyCompactItemize}


\subsection{Detailed Description}
The \hyperlink{class_c_semaphore}{C\-Semaphore} class provides two kinds semaphore which counting and binary. 

\begin{DoxyNote}{Note}
\hyperlink{class_c_semaphore}{C\-Semaphore} cannot be used before a call to member counting or binary. 
\end{DoxyNote}


\subsection{Member Function Documentation}
\hypertarget{class_c_semaphore_a0fc078dfd286cb3321c6cbaf7bcbb7b2}{\index{C\-Semaphore@{C\-Semaphore}!binary@{binary}}
\index{binary@{binary}!CSemaphore@{C\-Semaphore}}
\subsubsection[{binary}]{\setlength{\rightskip}{0pt plus 5cm}virtual bool C\-Semaphore\-::binary (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{class_c_semaphore_a0fc078dfd286cb3321c6cbaf7bcbb7b2}
Call the member function to creates a binary semaphore. \begin{DoxyReturn}{Returns}
true if create semaphore successful; otherwise, failed. 
\end{DoxyReturn}
\begin{DoxyNote}{Note}
Binary semaphores and mutexes are very similar but have some subtle differences\-: Mutexes include a priority inheritance mechanism, binary semaphores do not. This makes binary semaphores the better choice for implementing synchronisation (between tasks or between tasks and an interrupt), and mutexes the better choice for implementing simple mutual exclusion. 
\end{DoxyNote}
\hypertarget{class_c_semaphore_af4e913cd2861355f8be2211ae21753ba}{\index{C\-Semaphore@{C\-Semaphore}!counting@{counting}}
\index{counting@{counting}!CSemaphore@{C\-Semaphore}}
\subsubsection[{counting}]{\setlength{\rightskip}{0pt plus 5cm}virtual bool C\-Semaphore\-::counting (
\begin{DoxyParamCaption}
\item[{int}]{count, }
\item[{int}]{init = {\ttfamily 0}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{class_c_semaphore_af4e913cd2861355f8be2211ae21753ba}
Call the member function to creates a counting semaphore. 
\begin{DoxyParams}{Parameters}
{\em count} & is a integer value to specified the maximum count thate can be reached. \\
\hline
{\em init} & is a integer value to assigned to the semaphore when it is created. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
true if create semaphore successful; otherwise, failed. 
\end{DoxyReturn}
\hypertarget{class_c_semaphore_aa1a25ff1be26f8dfdd0f008aeabec8b1}{\index{C\-Semaphore@{C\-Semaphore}!release@{release}}
\index{release@{release}!CSemaphore@{C\-Semaphore}}
\subsubsection[{release}]{\setlength{\rightskip}{0pt plus 5cm}virtual int C\-Semaphore\-::release (
\begin{DoxyParamCaption}
\item[{bool}]{from\-I\-S\-R = {\ttfamily false}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{class_c_semaphore_aa1a25ff1be26f8dfdd0f008aeabec8b1}
Call the member function to release a semaphore. 
\begin{DoxyParams}{Parameters}
{\em from\-I\-S\-R} & is a boolean to specified the release occur from interrupt routine. (internal used) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
a integer value to identify the context switch wake. (internal used)
\end{DoxyReturn}

\begin{DoxyCode}
Example:
        \hyperlink{class_c_semaphore}{CSemaphore} semLED;

        \textcolor{comment}{// resource}
        \hyperlink{class_c_bus}{CBus} leds(LED1, LED2, LED3, LED4, END);
        \textcolor{keywordtype}{int}  index;

        \textcolor{comment}{// task1}
        \textcolor{keyword}{class }Task1: \textcolor{keyword}{public} \hyperlink{class_c_thread}{CThread} \{
        \textcolor{keyword}{protected}:
            \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} run() \{
                \textcolor{keywordflow}{while}(1) \{
                    index = rand() % 4;     \textcolor{comment}{// get a random value in 0~3.}
                    semLED.\hyperlink{class_c_semaphore_aa1a25ff1be26f8dfdd0f008aeabec8b1}{release}();       \textcolor{comment}{// release resource.}
                    sleep(500);
                \}
            \}
        \};

        \textcolor{comment}{// task2}
        \textcolor{keyword}{class }Task2: \textcolor{keyword}{public} \hyperlink{class_c_thread}{CThread} \{
    \textcolor{keyword}{protected}:
            \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} run() \{
                \textcolor{keywordflow}{while}(1) \{
                    semLED.\hyperlink{class_c_semaphore_abad6f22e40a0d911e38ade968f4d801a}{wait}();          \textcolor{comment}{// wait resource available.}
                    leds[index] = !leds[index];
                \}
            \}
        \}

        \textcolor{keywordtype}{void} main() \{
            ...
            semLED.\hyperlink{class_c_semaphore_a0fc078dfd286cb3321c6cbaf7bcbb7b2}{binary}();    \textcolor{comment}{// set the semaphore in binary mode}
            ...
        \}
\end{DoxyCode}
 \hypertarget{class_c_semaphore_abad6f22e40a0d911e38ade968f4d801a}{\index{C\-Semaphore@{C\-Semaphore}!wait@{wait}}
\index{wait@{wait}!CSemaphore@{C\-Semaphore}}
\subsubsection[{wait}]{\setlength{\rightskip}{0pt plus 5cm}virtual bool C\-Semaphore\-::wait (
\begin{DoxyParamCaption}
\item[{int}]{timeout = {\ttfamily MAX\-\_\-DELAY\-\_\-TIME}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{class_c_semaphore_abad6f22e40a0d911e38ade968f4d801a}
Call the member function to wait a semaphore available. 
\begin{DoxyParams}{Parameters}
{\em timeout} & is a integer value to specified the millisecond to wait for the semaphore to become available. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
true if create semaphore successful; otherwise, failed.
\end{DoxyReturn}

\begin{DoxyCode}
Example:
        \hyperlink{class_c_semaphore}{CSemaphore} semLED;

        \textcolor{comment}{// resource}
        \hyperlink{class_c_bus}{CBus} leds(LED1, LED2, LED3, LED4, END);
        \textcolor{keywordtype}{int}  index;

        \textcolor{comment}{// task1}
        \textcolor{keyword}{class }Task1: \textcolor{keyword}{public} \hyperlink{class_c_thread}{CThread} \{
        \textcolor{keyword}{protected}:
            \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} run() \{
                \textcolor{keywordflow}{while}(1) \{
                    index = rand() % 4;     \textcolor{comment}{// get a random value in 0~3.}
                    semLED.\hyperlink{class_c_semaphore_aa1a25ff1be26f8dfdd0f008aeabec8b1}{release}();       \textcolor{comment}{// release resource.}
                    sleep(500);
                \}
            \}
        \};

        \textcolor{comment}{// task2}
        \textcolor{keyword}{class }Task2: \textcolor{keyword}{public} \hyperlink{class_c_thread}{CThread} \{
    \textcolor{keyword}{protected}:
            \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} run() \{
                \textcolor{keywordflow}{while}(1) \{
                    semLED.\hyperlink{class_c_semaphore_abad6f22e40a0d911e38ade968f4d801a}{wait}();          \textcolor{comment}{// wait resource available.}
                    leds[index] = !leds[index];
                \}
            \}
        \}

        \textcolor{keywordtype}{void} main() \{
            ...
            semLED.\hyperlink{class_c_semaphore_a0fc078dfd286cb3321c6cbaf7bcbb7b2}{binary}();    \textcolor{comment}{// set the semaphore in binary mode}
            ...
        \}
\end{DoxyCode}
 \hypertarget{class_c_semaphore_a2302ceb8f2f9e1bef3381f457589177d}{\index{C\-Semaphore@{C\-Semaphore}!waiting@{waiting}}
\index{waiting@{waiting}!CSemaphore@{C\-Semaphore}}
\subsubsection[{waiting}]{\setlength{\rightskip}{0pt plus 5cm}virtual int C\-Semaphore\-::waiting (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{class_c_semaphore_a2302ceb8f2f9e1bef3381f457589177d}
Number of task in waiting 

The documentation for this class was generated from the following file\-:\begin{DoxyCompactItemize}
\item 
semaphore.\-h\end{DoxyCompactItemize}
